$arena = @'
################################################################################
#..............................................................................#
#......................................................................K.......#
#..............................................................................#
#..............................................................................#
#..............................................................................#
#......................................K.......................................#
#..............................................................................#
#..............................................................................#
#.........................K............@.......................................#
#..............................................................................#
#..............................................................................#
#..............................................................................#
#..............................................................................#
#................................................K.............................#
#..............................................................................#
#......K.......................................................................#
#..............................................................................#
################################################################################
'@

$arena2 = @'
################################################################################
#..K..................$........................................................#
#......................................................................K.......#
#.................####.####....................................................#
#.................#..#-#..#....................................................#
#.................####.####..................###############...................#
#......................................K.....#.............#...................#
#............................................#.............#...................#
#............................................###############...................#
#............###..........K............@.......................................#
#............#.#.............................###############...................#
#............###.............................#.............#...................#
#.............+..............................#.............#...................#
#............###.............................###############...................#
#............#.#.................................K.............................#
#............###...............................................................#
#......K.......................................................................#
#............................................................................>.#
################################################################################
'@

$dungeon1 = @'
                                                                 _______________
                 _______                                         _.!..........._
                 _.$..._                                         _............._
                 _=^.K.+################                         _......D......_
                 _....._               #                         _............._
                 _....._               #                         _.........]..._
                 ___-___           ____+_____                    _______+_______
                    #              _........_                           #       
                    #              _........_                           #       
                    #:#############+....@...+#########K####             #       
                                   _........_             #             #       
                                   _........_             #             #       
                                   __________             #       ______+______ 
                                                       ___+___    _..........._ 
                                                       _.....&####+....)......_ 
                                                       _.>..._    _.........?._ 
                                                       _______    _____________ 
                                                                                
'@
$dungeon1a = @'
                                                                                
                 #######                                                        
                 #.$...##################                                       
                 #...K..................#                                       
                 #.....################.#                                       
                 #.....#              #.#                                       
                 ###-###           ####.#####                                   
                   #.#             #........#                                   
                   #.###############........################                    
                   #...................@.............K.....#                    
                   #################........######.#######.#                    
                                   #........#............#.#                    
            #################################............#.#                    
            #......................#...................###.###                  
            #......................######..............#.....#                  
            #......................#...................#.>...#                  
            #.........................#................#######                  
            ############################################                        
'@
$dungeon2 = @'
lqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqk
x                lqqqqqk                                                       x
x                x.$...mqqqqqqqqqqqqqqqqk                                      x
x                x...K..................x                                      x
x                x.....lqqqqqqqqqqqqqqk.x                                      x
x                x.....x              x.x                                      x
x                mqk-lqj           lqqj.mqqqk                                  x
x                  x.mqqqqqqqqqqqqqj........mqqqqqqqqqqqqqqk                   x
x                  x...................@.............K.....x                   x
x                  mqqqqqqqqqqqqqqqk........lqqqqqqqqqqqqk.x                   x
x                                  x........x            x.x                   x
x                                  mqqqqqqqqj            x.x                   x
x                                                      lqj.mqk                 x
x                                                      x.....x                 x
x                                                      x.>...x                 x
x                                                      x.....x                 x
x                                                      mqqqqqj                 x
mqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqj
'@


# function showArena {
#     createMapFromLevel @{level = $arena; mapGen = $mapGen}
# }

function showLevelTest($level) {
    createMapFromLevel (@{level = $level; mapGen = $mapGen})
}


function Test {
    CreateMap $game
}


if (!$game) {
    . .\host.ps1
    . .\mapgen.ps1
    . .\map.ps1
    
    function GameAddEntity($entity) {}
}
function CreateMap {
    # $game.MapWindow | Format-List
    # $game.InventoryWindow | Format-List
    # $game.LogWindow | Format-List
    # $game.StatusWindow | Format-List
    # read-host
    # showLevelTest $game $dungeon1
    CreateLevel 1
    # createMapFromLevel (@{level = $dungeon1a; mapGen = $mapGen; DrawLines = $true})
    #createMapFromLevel (@{level = $arena2; mapGen = $mapGen; DrawLines = $true})
    #createMapFromLevel (@{level = $dungeon1; mapGen = $mapGen; DrawLines = "_"})
    #createMapFromLevel (@{level = $dungeon2; mapGen = $mapGen; dec = $true})
    # $game
    # $game.rogue
    #$game.map | Format-List

    # $log = GetWindow "LogWindow"
    # PrintToWindow "LogWindow" 0 0 "1234567890"
    # PrintToWindow "LogWindow" 0 1 "234567890"
    # PrintToWindow "LogWindow" 0 2 "34567890"
    # PrintToWindow "LogWindow" 0 3 "4567890"
    # $src = RectLTRB ($log.Position.X) $log.Position.Y 3 ($log.Position.Y+3)
    # $Host.UI.RawUI | Format-List
    # Read-Host "$($src.Right) $($src.Bottom) $((PointFromWindow $log 1 0).Y)"
    # ScrollBufferContents $src (PointFromWindow $log 0 1) $src (CreateCell "X" "Red" "Yellow")
}

# function DrawStats {
#     DrawOrbit $game
# }

if (!$game) {

    $game = @{
        ui = $host.ui.RawUI
        MapWindow = RectLTRB 0 0 80 50
    }
    
    Test
    Read-Host
}